---
// src/components/PropertyCard.astro
import type { Property } from '../lib/api';

export interface Props {
  property: Property;
}
const { property: p } = Astro.props;

const ICONS: Record<string, string> = {
  Flat: 'üè¢', House: 'üè°', Studio: 'üè†', Cottage: 'üè°', Bungalow: 'üèòÔ∏è',
};
const icon = ICONS[p.property_type] ?? 'üè†';

const isSale = p.tenure === 'sale';
const priceLabel = isSale
  ? `¬£${p.price.toLocaleString()}`
  : `¬£${p.price.toLocaleString()} /mo`;

const bedroomLabel = p.bedrooms === 0 ? 'Studio' : `${p.bedrooms} Bed${p.bedrooms > 1 ? 's' : ''}`;
---
<a href={`/property/${p.id}`} class="prop-card">
  <div class="prop-image">{icon}</div>
  <div class="prop-body">
    <div class="prop-top">
      <div>
        <h3 class="prop-title">{p.title}</h3>
        <p class="prop-type">{p.property_type} ¬∑ {p.location}</p>
      </div>
      <span class={`prop-badge ${isSale ? 'badge-sale' : 'badge-rent'}`}>
        {isSale ? 'For Sale' : 'To Rent'}
      </span>
    </div>
    <div class="prop-price">{priceLabel}</div>
    <div class="prop-specs">
      <span>üõè {bedroomLabel}</span>
      <span>üöø {p.bathrooms} Bath{p.bathrooms > 1 ? 's' : ''}</span>
      <span>üè∑ {p.property_type}</span>
    </div>
    <div class="prop-cta">View Details ‚Üí</div>
  </div>
</a>

<style>
.prop-card {
  display: block;
  background: var(--hl-white);
  border-radius: var(--hl-radius);
  overflow: hidden;
  box-shadow: var(--hl-shadow);
  transition: transform 0.25s, box-shadow 0.25s;
}
.prop-card:hover {
  transform: translateY(-4px);
  box-shadow: var(--hl-shadow-hover);
}
.prop-image {
  width: 100%; height: 180px;
  background: linear-gradient(135deg, #e8f8fb, #d0f0e0);
  display: flex; align-items: center; justify-content: center;
  font-size: 4.5rem;
}
.prop-body { padding: 1.25rem; }
.prop-top {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  gap: 0.75rem;
  margin-bottom: 0.5rem;
}
.prop-title { font-size: 1.15rem; font-weight: 700; color: var(--hl-dark); }
.prop-type  { font-size: 0.85rem; color: var(--hl-grey); margin-top: 0.2rem; }
.prop-badge {
  padding: 0.25rem 0.65rem;
  border-radius: 20px;
  font-size: 0.78rem;
  font-weight: 700;
  white-space: nowrap;
  flex-shrink: 0;
}
.badge-sale { background: #E8F8FB; color: var(--hl-cyan); }
.badge-rent { background: #E8F5EC; color: var(--hl-green); }
.prop-price {
  font-size: 1.5rem;
  font-weight: 700;
  color: var(--hl-cyan);
  margin-bottom: 0.75rem;
}
.prop-specs {
  display: flex;
  gap: 1rem;
  flex-wrap: wrap;
  background: var(--hl-light);
  border-radius: 8px;
  padding: 0.6rem 0.75rem;
  font-size: 0.88rem;
  color: var(--hl-grey);
  margin-bottom: 1rem;
}
.prop-cta {
  font-weight: 700;
  color: var(--hl-cyan);
  font-size: 0.95rem;
}
</style>
